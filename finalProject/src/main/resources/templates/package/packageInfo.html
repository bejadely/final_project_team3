<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="@{layouts/default_layout}">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<style>
form {
	text-align: center;
}

.contentStyle{
	width:400px;
	height:400px;
	margin: 0 auto;
}
.pt img{
	width:200px;
	height:200px;
}
</style>

</head>
<body>

<div layout:fragment="content">
 <section class="property-details-section spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-9">
                    <div class="pd-details-text">
                    <h4>[[ ${info.name} ]]</h4>
                        <div class="pd-details-social">
                            <a href="#"><i class="fa fa-facebook"></i></a>
                            <a href="#"><i class="fa fa-send"></i></a>
                            <a href="#"><i class="fa fa-star"></i></a>
                            <a href="#"><i class="fa fa-print"></i></a>
                            <a href="#"><i class="fa fa-cloud-download"></i></a>
                        </div>
                        <div class="property-more-pic">
                            <div class="product-pic-zoom">
                               
                            </div>
                            <div class="product-thumbs">
                                <div class="product-thumbs-track ps-slider owl-carousel">
                                    
                                </div>
                            </div>
                        </div>
                       
                        
                            <div class="pd-details-tab">
                            <div class="tab-item">
                                <ul class="nav" role="tablist">
                                    <li>
                                        <a class="active" data-toggle="tab" href="#tab-1" role="tab">패키지 정보</a>
                                    </li>
                                    <li>
                                        <a data-toggle="tab" href="#tab-2" role="tab">패키지 내용</a>
                                    </li>
                                    <li>
                                        <a data-toggle="tab" href="#tab-3" role="tab">Amenities</a>
                                    </li>
                                </ul>
                            </div>
                            <div class="tab-item-content">
                                <div class="tab-content">
                                    <div class="tab-pane fade-in active" id="tab-1" role="tabpanel">
                                        <div class="property-more-table">
                                            <table class="left-table">
                                                <tbody>
                                                    <tr>
                                                        <td class="pt-name">Price</td>
                                                        <td class="p-value">[[ ${info.price} ]]</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="pt-name">패키지 테마</td>
                                                        <td class="p-value">[[ ${info.tourTheme} ]]</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="pt-name">여행 시작일</td>
                                                        <td class="p-value">[[ ${#dates.format(info.startDate, 'yyyy년 MM월 dd일')} ]]</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="pt-name">여행 종료일</td>
                                                        <td class="p-value">[[ ${#dates.format(info.endDate, 'yyyy년 MM월 dd일')} ]]</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="pt-name">모집 마감일</td>
                                                        <td class="p-value">[[ ${#dates.format(info.deadlineDate, 'yyyy년 MM월 dd일')} ]]</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="pt-name">모집 인원</td>
                                                        <td class="p-value">[[ ${info.maxReservation} ]]</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="pt-name">Lot area</td>
                                                        <td class="p-value">200 spft</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table class="right-table">
                                                <tbody>
                                                    <tr>
                                                        <td class="pt-name">Agent</td>
                                                        <td class="p-value">Adam Smith</td>
                                                    </tr>
                                                   <tr>
                                                        <td class="pt-name">Reference</td>
                                                        <td class="p-value">#2019</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="pt-name">Contract type</td>
                                                        <td class="p-value">Sale</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="pt-name">Beds</td>
                                                        <td class="p-value">4</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="pt-name">Garages</td>
                                                        <td class="p-value">2</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="pt-name">Home area</td>
                                                        <td class="p-value">1200 sqft</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="pt-name">Gara Size</td>
                                                        <td class="p-value">200 sqft</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="tab-2" role="tabpanel">
                                        <div class="pd-table-desc" th:utext="${info.content }" >
                                           
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="tab-3" role="tabpanel">
                                        <div class="pd-table-amenities">
                                            <p>Learn how to improve your playing quality and even overall understanding
                                                of online gaming and how you perform while playing online. Gaming online
                                                is a huge business nowadays and that means that there are millions of
                                                people worldwide at online game sites all the time. Many are people just
                                                like you and me that like to play online and have fun doing it. Some of
                                                these people enjoy it so much, that they often do not even care about
                                                improving their skill and raising their chances of winning.</p>
                                            <p>Learn how to improve your playing quality and even overall understanding
                                                of online gaming and how you perform while playing online. Gaming online
                                                is a huge business nowadays and that means that there are millions of
                                                people worldwide at online game sites all the time. Many are people just
                                                like you and me that like to play online and have fun doing it. Some of
                                                these people enjoy it so much, that they often do not even care about
                                                improving their skill and raising their chances of winning.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    <!--<div class="pd-desc">
                            <h4>패키지 설명</h4>
                            <div th:utext="${info.content }" class="contentStyle"></div>
                        </div>-->
                    </div>
                </div>
               <div class="col-lg-3">
                    <div class="property-sidebar">
                        <h4>구매하기</h4>
                            <div class="sidebar-btn">
                                <div class="bt-item">
                                    <input type="radio" name="kakaoPay" id="kakaoPay" >
                                    <label for="kakaoPay">Buy</label>
                                </div>
                                <div class="bt-item">
                                    <input type="radio" name="cartBtn" id="cartBtn">
                                    <label for="cartBtn">Cart</label>
                                </div>
                            </div>
                            <div>
							    <label for="numOfBuy">구매 인원</label>
							    <input type="number" id="quantity" min="1" value="1" >
							    <button id="calculate">계산</button>
							</div>
							
							<!-- 총 금액 표시 -->
							<div id="totalPriceDisplay">
							    총 금액: <span id="totalPrice">0</span> 원
							</div>
                    </div>
                </div>
            </div>
        </div>
        		
    </section>
    <!-- Property Details Section End -->
	 <div class="partner-section">
        <div class="container">
            <div class="partner-carousel owl-carousel">
                <a href="#" class="partner-logo">
                    <div class="partner-logo-tablecell">
                        <img src="img/partner/partner-1.png" alt="">
                    </div>
                </a>
                <a href="#" class="partner-logo">
                    <div class="partner-logo-tablecell">
                        <img src="img/partner/partner-2.png" alt="">
                    </div>
                </a>
                <a href="#" class="partner-logo">
                    <div class="partner-logo-tablecell">
                        <img src="img/partner/partner-3.png" alt="">
                    </div>
                </a>
                <a href="#" class="partner-logo">
                    <div class="partner-logo-tablecell">
                        <img src="img/partner/partner-4.png" alt="">
                    </div>
                </a>
                <a href="#" class="partner-logo">
                    <div class="partner-logo-tablecell">
                        <img src="img/partner/partner-5.png" alt="">
                    </div>
                </a>
            </div>
        </div>
        <input type="hidden" id="id" th:value="${session.sessionId}">
    </div>
    <!-- Partner Carousel Section End -->

<script>
	var content = '[[${info.content }]]';
	var postId = '[[${info.postId}]]';
	var memberId = $("#id").val();
	$(document).ready(function(){
		(function(){
			$.getJSON("getAttachList",{postId:postId},function(arr){
				var str="";
				var str2="";
				$(arr).each(function(i, attach){
					if(i==0){
						str+=`<img src="${attach.loadingImg}" class="product-big-img"  alt="">`	
					}
					else{
						str2+=`<div class="pt" data-imgbigurl="${attach.loadingImg}"><img
                            src="${attach.loadingImg}" alt=""></div>`
					}
				});
				$(".product-pic-zoom").html(str);
				$(".product-thumbs-track.ps-slider.owl-carousel").html(str2);
			});
		})();
		   
	});
		
	
	 function calculatePrice(pricePerPerson) {
	        const quantity = parseInt(document.getElementById('quantity').value);
	        const totalPrice = pricePerPerson * quantity;
	        return totalPrice;
	    }

	    // 모집 인원 입력 변경 이벤트 처리
	    document.getElementById('calculate').addEventListener('click', function() {
	        const pricePerPerson =[[ ${info.price} ]]; // 가격 가져오기
	        const totalPrice = calculatePrice(pricePerPerson);

	        // 총 금액 표시 업데이트
	        document.getElementById('totalPrice').textContent = totalPrice;
	        
	    });

	    // 결제 버튼 클릭 이벤트 처리
	    document.getElementById('kakaoPay').addEventListener('click', function() {
	        // 여기에 결제 페이지로 이동하는 코드 추가
	        // 예를 들어, window.location.href = '결제페이지URL';
	        let totalAmount = parseInt($("#totalPrice").text());
	        let orderName = "[[ ${info.name} ]]";
	        let postId = "[[ ${info.postId} ]]"
	        let quantity = parseInt(document.getElementById('quantity').value);
	     
	        $.ajax({
	        	type:'post',
	        	url:'payment/ready',
	        	data:{
	        		totalAmount: totalAmount,
	        		orderName : orderName,
	        		quantity : quantity,
	        		postId: postId,
	        		partnerUserId: memberId
	        	},
	        	success:function(response){
	        		location.href = response.next_redirect_pc_url
	        	}
	        	
	        });
	    });
	    
	    document.getElementById('cartBtn').addEventListener('click',function(){
	    	let totalAmount = parseInt($("#totalPrice").text());
	        let orderName = "[[ ${info.name} ]]";
	        let postId = "[[ ${info.postId} ]]"
	        let quantity = parseInt(document.getElementById('quantity').value);
	    	
	    	console.log(memberId);
	    	$.ajax({
	    		type:'post',
	    		url:'/cartInsert',
	    		data:{
	    			price: totalAmount,
	        		cartName : orderName,
	        		quantity : quantity,
	        		postId: postId,
	        		memberId : memberId			
	    		},
	    		success:function(message){
	    			alert(message);
	    		}
	    	});
	    });

</script>
</div>
</body>
</html>